# –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ –∑ –ª–æ–≥—É 10-05 14-01-2026

## üî¥ –ö–†–ò–¢–ò–ß–ù–ê –ü–†–û–ë–õ–ï–ú–ê: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó (Side Mismatch)

### –ü—Ä–æ–±–ª–µ–º–∞
–ë–æ—Ç –≤—ñ–¥–∫—Ä–∏–≤–∞—î –ø–æ–∑–∏—Ü—ñ—é –∑ –æ–¥–Ω—ñ—î—é —Å—Ç–æ—Ä–æ–Ω–æ—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, SHORT), –∞–ª–µ –Ω–∞ –±—ñ—Ä–∂—ñ Binance –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ (LONG). –¶–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ:
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É P&L
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö SL/TP –æ—Ä–¥–µ—Ä—ñ–≤
- –í–µ–ª–∏–∫–∏—Ö –∑–±–∏—Ç–∫—ñ–≤ —á–µ—Ä–µ–∑ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø–æ–∑–∏—Ü—ñ—ó

**–ü—Ä–∏–∫–ª–∞–¥ –∑ –ª–æ–≥—É:**
- –ë–æ—Ç –≤—ñ–¥–∫—Ä–∏–≤: `>>> OPENING SHORT on BULLAUSDT <<<`
- –ù–∞ –±—ñ—Ä–∂—ñ: `BULLAUSDT: Long, Size 65,206 BULLA, Entry 0.0361549, PnL -45.86 USDT`
- –í –ª–æ–≥–∞—Ö –±–æ—Ç–∞: `[BULLAUSDT] SHORT | Entry: 0.03683075 | Now: 0.03683443 | PnL: -0.12 USDT`

### –ü—Ä–∏—á–∏–Ω–∏
1. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–µ–∞–ª—å–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó –Ω–∞ –±—ñ—Ä–∂—ñ –ø—ñ—Å–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è** - –±–æ—Ç –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è–≤, —á–∏ —Å–ø—ñ–≤–ø–∞–¥–∞—î —Å—Ç–æ—Ä–æ–Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó –∑ —Ç–∏–º, —â–æ –æ—á—ñ–∫—É–≤–∞–ª–æ—Å—è
2. **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó** - —è–∫—â–æ –Ω–∞ –±—ñ—Ä–∂—ñ –≤–∂–µ —î –ø–æ–∑–∏—Ü—ñ—è –≤ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É, –Ω–æ–≤–∏–π –æ—Ä–¥–µ—Ä –º–æ–∂–µ –∑–∞–∫—Ä–∏—Ç–∏ —ó—ó –∑–∞–º—ñ—Å—Ç—å –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –Ω–æ–≤–æ—ó
3. **–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ side –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –ø–æ–∑–∏—Ü—ñ—ó** - –±–æ—Ç –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è–≤ side –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –ø–æ–∑–∏—Ü—ñ—ó

### –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

#### 1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è (`core/position_tracker.py`)

–î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ä–µ–∞–ª—å–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó –Ω–∞ –±—ñ—Ä–∂—ñ –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è (–∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é 0.5 —Å–µ–∫ –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –Ω–∞ –±—ñ—Ä–∂—ñ):

```python
# CRITICAL: Verify actual position on exchange immediately after opening
# This catches cases where the order was filled with wrong side or other issues
try:
    time.sleep(0.5)  # Small delay to ensure position is registered on exchange
    exchange_positions = self.client.get_positions(symbol)
    if exchange_positions:
        exchange_pos = exchange_positions[0]
        actual_side = "LONG" if exchange_pos.size > 0 else "SHORT"
        actual_size = abs(exchange_pos.size)
        actual_entry = exchange_pos.entry_price
        
        # Check if side matches - CRITICAL ERROR if not
        if actual_side != side:
            logger.error(f"[CRITICAL] {symbol}: Position {position_id} SIDE MISMATCH! ...")
            
            # Check if hedge exists (might explain the mismatch)
            hedge = self.hedge_manager.get_hedge_for_parent(position_id)
            if hedge and hedge.is_open:
                # Hedge exists - NET side may be different
                position.has_hedge = True
                position.hedge_id = hedge.hedge_id
            else:
                # No hedge - this is a real error, update to match exchange
                position.side = actual_side
                position.quantity = actual_size
                position.entry_price = actual_entry
```

**–©–æ —Ü–µ –≤–∏—Ä—ñ—à—É—î:**
- –ë–æ—Ç –æ–¥—Ä–∞–∑—É –≤–∏—è–≤–ª—è—î, —è–∫—â–æ —Å—Ç–æ—Ä–æ–Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—î
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–ø—Ä–∞–≤–ª—è—î side, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –±—ñ—Ä–∂—ñ (–¥–∂–µ—Ä–µ–ª–æ –ø—Ä–∞–≤–¥–∏)
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å hedge –ø–µ—Ä–µ–¥ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º (hedge –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ NET side)

#### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó –ø–µ—Ä–µ–¥ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è–º (`core/order_manager.py`)

–î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó –ø–µ—Ä–µ–¥ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è–º –Ω–æ–≤–æ—ó:

```python
# CRITICAL: Check if there's an existing position in opposite direction
try:
    existing_positions = self.client.get_positions(symbol)
    if existing_positions:
        existing_pos = existing_positions[0]
        existing_side = "LONG" if existing_pos.size > 0 else "SHORT"
        if existing_side != side:
            logger.warning(f"[ENTRY] {symbol}: Existing {existing_side} position detected ... "
                         f"New order may close existing position instead of opening new one!")
```

**–©–æ —Ü–µ –≤–∏—Ä—ñ—à—É—î:**
- –ü–æ–ø–µ—Ä–µ–¥–∂–∞—î –ø—Ä–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
- –î–æ–∑–≤–æ–ª—è—î –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —á–æ–º—É –Ω–æ–≤–∏–π –æ—Ä–¥–µ—Ä –º–æ–∂–µ –∑–∞–∫—Ä–∏—Ç–∏ —ñ—Å–Ω—É—é—á—É –ø–æ–∑–∏—Ü—ñ—é –∑–∞–º—ñ—Å—Ç—å –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –Ω–æ–≤–æ—ó

#### 3. –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ side –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –ø–æ–∑–∏—Ü—ñ—ó (`main.py`)

–ü–æ–∫—Ä–∞—â–µ–Ω–æ –ª–æ–≥—ñ–∫—É –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ side –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –ø–æ–∑–∏—Ü—ñ—ó:

```python
# CRITICAL: Always verify position side from exchange (source of truth)
if exchange_pos:
    actual_side = "LONG" if exchange_pos.size > 0 else "SHORT"
    actual_size = abs(exchange_pos.size)
    actual_entry = exchange_pos.entry_price
    
    # CRITICAL: If side doesn't match and no hedge, this is a serious error
    if position.side != actual_side:
        if position.has_hedge and (hedge_exists or hedge_exists_by_size):
            # Hedge exists - NET side can be different, this is expected
            logger.debug(f"[SYNC] {symbol}: Hedge exists, NET side {actual_side} != tracked side {position.side} (expected)")
        else:
            # No hedge but side mismatch - CRITICAL ERROR
            logger.error(f"[CRITICAL] {symbol}: Position {position_id} SIDE MISMATCH! ...")
            
            # Update to match exchange (source of truth)
            position.side = actual_side
            position.quantity = actual_size
            position.entry_price = actual_entry
```

**–©–æ —Ü–µ –≤–∏—Ä—ñ—à—É—î:**
- –ü–æ—Å—Ç—ñ–π–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ side –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –ø–æ–∑–∏—Ü—ñ—ó
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è side, —è–∫—â–æ –≤—ñ–Ω –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—î
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ hedge (NET side –º–æ–∂–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è)

### –†–µ–∑—É–ª—å—Ç–∞—Ç

1. **–ú–∏—Ç—Ç—î–≤–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫** - –±–æ—Ç –æ–¥—Ä–∞–∑—É –≤–∏—è–≤–ª—è—î, —è–∫—â–æ —Å—Ç–æ—Ä–æ–Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—î –∑ –æ—á—ñ–∫—É–≤–∞–Ω–æ—é
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è** - –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–ø—Ä–∞–≤–ª—è—î side, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –±—ñ—Ä–∂—ñ
3. **–î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è** - –≤—Å—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –¥–µ—Ç–∞–ª—å–Ω–æ –ª–æ–≥—É—é—Ç—å—Å—è –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É
4. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ hedge** - –±–æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—î –≤–∏–ø–∞–¥–∫–∏, –∫–æ–ª–∏ hedge –∑–º—ñ–Ω—é—î NET side

### –î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

1. **–î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ –ø–æ–∑–∏—Ü—ñ—ó:**
   - –õ–æ–≥—É—î—Ç—å—Å—è –æ—á—ñ–∫—É–≤–∞–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞, —Ä–æ–∑–º—ñ—Ä —Ç–∞ —Ü—ñ–Ω–∞ –≤—Ö–æ–¥—É
   - –õ–æ–≥—É—î—Ç—å—Å—è —Ä–µ–∞–ª—å–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞, —Ä–æ–∑–º—ñ—Ä —Ç–∞ —Ü—ñ–Ω–∞ –≤—Ö–æ–¥—É –∑ –±—ñ—Ä–∂—ñ
   - –õ–æ–≥—É—î—Ç—å—Å—è P&L –∑ –±—ñ—Ä–∂—ñ –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

2. **–ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –ø—Ä–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó:**
   - –ë–æ—Ç –ø–æ–ø–µ—Ä–µ–¥–∂–∞—î, —è–∫—â–æ –Ω–∞ –±—ñ—Ä–∂—ñ –≤–∂–µ —î –ø–æ–∑–∏—Ü—ñ—è –≤ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É
   - –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —á–æ–º—É –Ω–æ–≤–∏–π –æ—Ä–¥–µ—Ä –º–æ–∂–µ –∑–∞–∫—Ä–∏—Ç–∏ —ñ—Å–Ω—É—é—á—É –ø–æ–∑–∏—Ü—ñ—é

3. **–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ hedge:**
   - –ë–æ—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å hedge –ø–µ—Ä–µ–¥ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º side
   - –Ø–∫—â–æ hedge —ñ—Å–Ω—É—î, NET side –º–æ–∂–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è, —ñ —Ü–µ –æ—á—ñ–∫—É–≤–∞–Ω–æ

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É

1. **–°—Ç–µ–∂–∏—Ç–∏ –∑–∞ –ª–æ–≥–∞–º–∏ `[CRITICAL]`** - —Ü—ñ –ª–æ–≥–∏ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Å–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑ side mismatch
2. **–ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è `[VERIFY]`** - —Ü–µ –ø–æ–∫–∞–∑—É—î, —á–∏ —Å–ø—ñ–≤–ø–∞–¥–∞—î —Å—Ç–æ—Ä–æ–Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó –∑ –æ—á—ñ–∫—É–≤–∞–Ω–æ—é
3. **–ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –ø—Ä–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó** - —Ü–µ –º–æ–∂–µ –ø–æ—è—Å–Ω–∏—Ç–∏, —á–æ–º—É –Ω–æ–≤–∏–π –æ—Ä–¥–µ—Ä –∑–∞–∫—Ä–∏–≤–∞—î —ñ—Å–Ω—É—é—á—É –ø–æ–∑–∏—Ü—ñ—é

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ü—ñ—Å–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ
2. –í—ñ–¥–∫—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –ø–æ–∑–∏—Ü—ñ–π
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —Å–ø—ñ–≤–ø–∞–¥–∞—î —Å—Ç–æ—Ä–æ–Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó –∑ –æ—á—ñ–∫—É–≤–∞–Ω–æ—é
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è side, —è–∫—â–æ –≤—ñ–Ω –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—î
5. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è hedge –ø–æ–∑–∏—Ü—ñ—ó
