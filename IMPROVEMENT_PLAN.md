# –î–µ—Ç–∞–ª—å–Ω–∏–π –ø–ª–∞–Ω –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è Trading Bot

## –ê–Ω–∞–ª—ñ–∑ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É

### –í–∏—è–≤–ª–µ–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏:

#### 1. üî¥ –ö–†–ò–¢–ò–ß–ù–ê: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è hedge –ø–æ–∑–∏—Ü—ñ–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ—Ç –ø–æ–∫–∞–∑—É—î `LONG[HEDGE]` –¥–ª—è BROCCOLI714USDT, –∞–ª–µ –Ω–∞ –±—ñ—Ä–∂—ñ –Ω–µ–º–∞—î hedge –ø–æ–∑–∏—Ü—ñ—ó.

**–ü—Ä–∏—á–∏–Ω–∞:**
- –í `position_tracker.py` (lines 485-497) –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ hedge —Å—Ç–∞—Ç—É—Å—É –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤ `update_position`, –∞–ª–µ:
  - –Ø–∫—â–æ hedge –±—É–≤ –∑–∞–∫—Ä–∏—Ç–∏–π –∑–∑–æ–≤–Ω—ñ (–Ω–∞ –±—ñ—Ä–∂—ñ), –±–æ—Ç –º–æ–∂–µ –Ω–µ –ø–æ–º—ñ—Ç–∏—Ç–∏ —Ü–µ –æ–¥—Ä–∞–∑—É
  - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ `hedge.is_open` –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ —Å—Ç–∞–Ω—É, –∞ –Ω–µ –≤—ñ–¥ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É –Ω–∞ –±—ñ—Ä–∂—ñ
  - NET –ø–æ–∑–∏—Ü—ñ—ó –Ω–∞ Binance (parent + hedge) –Ω–µ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —Ç–æ—á–Ω–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —á–∏ —î –æ–∫—Ä–µ–º–∞ hedge –ø–æ–∑–∏—Ü—ñ—è

**–†—ñ—à–µ–Ω–Ω—è:**
- –î–æ–¥–∞—Ç–∏ –∞–≥—Ä–µ—Å–∏–≤–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É hedge –ø–æ–∑–∏—Ü—ñ–π —á–µ—Ä–µ–∑ exchange API
- –ü—Ä–∏ reconciliation –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π NET size –Ω–∞ –±—ñ—Ä–∂—ñ
- –Ø–∫—â–æ NET size –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –æ—á—ñ–∫—É–≤–∞–Ω–æ–º—É (parent quantity), hedge –≤–≤–∞–∂–∞—î—Ç—å—Å—è –∑–∞–∫—Ä–∏—Ç–∏–º
- –î–æ–¥–∞—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π –∑ hedge

#### 2. ‚ö†Ô∏è –í–ê–ñ–õ–ò–í–ê: –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—î –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–º–æ–∂–ª–∏–≤–æ –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—Ä–æ—Å—Ç–µ–∂–∏—Ç–∏, —â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑ –ø–æ–∑–∏—Ü—ñ—è–º–∏ —Ç–∞ hedge.

**–†—ñ—à–µ–Ω–Ω—è:**
- –î–æ–¥–∞—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π –∑ –ø–æ–∑–∏—Ü—ñ—è–º–∏
- –õ–æ–≥—É–≤–∞—Ç–∏ reconciliation —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
- –õ–æ–≥—É–≤–∞—Ç–∏ –≤—Å—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ hedge —Å—Ç–∞—Ç—É—Å—É
- –î–æ–¥–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è NET –ø–æ–∑–∏—Ü—ñ–π –∑ –±—ñ—Ä–∂—ñ –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

#### 3. ‚ö†Ô∏è –í–ê–ñ–õ–ò–í–ê: –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—î –ª–æ–≥—É–≤–∞–Ω–Ω—è —Å—Ç–æ–ø-–ª–æ—Å—ñ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –∑–∞–≤–∂–¥–∏ –∑—Ä–æ–∑—É–º—ñ–ª–æ, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ —Å—Ç–æ–ø-–ª–æ—Å–∏.

**–†—ñ—à–µ–Ω–Ω—è:**
- –î–æ–¥–∞—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è SL
- –õ–æ–≥—É–≤–∞—Ç–∏ –≤—Å—ñ —Å–ø—Ä–æ–±–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è SL
- –õ–æ–≥—É–≤–∞—Ç–∏ –ø—Ä–∏—á–∏–Ω–∏ –Ω–µ–≤–¥–∞—á
- –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ SL –æ—Ä–¥–µ—Ä—ñ–≤ –Ω–∞ –±—ñ—Ä–∂—ñ

#### 4. üîµ –ü–û–ö–†–ê–©–ï–ù–ù–Ø: –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è reconciliation
**–ü—Ä–æ–±–ª–µ–º–∞:** Reconciliation –º–æ–∂–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç–∏ –∑–º—ñ–Ω–∏ –Ω–∞ –±—ñ—Ä–∂—ñ.

**–†—ñ—à–µ–Ω–Ω—è:**
- –ë—ñ–ª—å—à –∞–≥—Ä–µ—Å–∏–≤–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–∑–∏—Ü—ñ–π
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ hedge —á–µ—Ä–µ–∑ NET positions
- –î–µ—Ç–∞–ª—å–Ω—ñ—à–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è reconciliation –æ–ø–µ—Ä–∞—Ü—ñ–π

## –ü–ª–∞–Ω –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó hedge –ø–æ–∑–∏—Ü—ñ–π
1. –î–æ–¥–∞—Ç–∏ –º–µ—Ç–æ–¥ `_verify_hedge_with_exchange()` –≤ `HedgeManager`
2. –ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ NET position size –Ω–∞ –±—ñ—Ä–∂—ñ
3. –û–Ω–æ–≤–ª—é–≤–∞—Ç–∏ `has_hedge` —Ñ–ª–∞–≥ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∑ –±—ñ—Ä–∂—ñ
4. –î–æ–¥–∞—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è

### –ö—Ä–æ–∫ 2: –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
1. –î–æ–¥–∞—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
2. –õ–æ–≥—É–≤–∞—Ç–∏ NET positions –∑ –±—ñ—Ä–∂—ñ
3. –õ–æ–≥—É–≤–∞—Ç–∏ hedge —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ
4. –õ–æ–≥—É–≤–∞—Ç–∏ SL/TP –æ–ø–µ—Ä–∞—Ü—ñ—ó –¥–µ—Ç–∞–ª—å–Ω—ñ—à–µ

### –ö—Ä–æ–∫ 3: –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è reconciliation
1. –ü–æ–∫—Ä–∞—â–∏—Ç–∏ `reconcile_with_exchange()` –≤ `PositionTracker`
2. –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É hedge —á–µ—Ä–µ–∑ NET positions
3. –î–æ–¥–∞—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è reconciliation –æ–ø–µ—Ä–∞—Ü—ñ–π

### –ö—Ä–æ–∫ 4: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç–∞ –Ω–∞ –≥–æ–¥–∏–Ω—É
2. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ª–æ–≥–∏
3. –í–∏–ø—Ä–∞–≤–∏—Ç–∏ –≤–∏—è–≤–ª–µ–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

## –î–µ—Ç–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–∏ –≤ –∫–æ–¥—ñ

### –§–∞–π–ª: `core/position_tracker.py`

#### –ó–º—ñ–Ω–∞ 1: –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ hedge —Å—Ç–∞—Ç—É—Å—É
```python
def _verify_hedge_with_exchange(self, position: TrackedPosition) -> bool:
    """
    –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–µ–∞–ª—å–Ω–∏–π hedge —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ exchange API.
    
    Binance –ø–æ–∫–∞–∑—É—î NET –ø–æ–∑–∏—Ü—ñ—é (parent + hedge), —Ç–æ–º—É:
    - –Ø–∫—â–æ NET size ‚âà parent.quantity ‚Üí hedge –Ω–µ–º–∞—î –∞–±–æ –∑–∞–∫—Ä–∏—Ç–∏–π
    - –Ø–∫—â–æ NET size < parent.quantity ‚Üí hedge —ñ—Å–Ω—É—î (—á–∞—Å—Ç–∫–æ–≤–æ –∫–æ–º–ø–µ–Ω—Å—É—î)
    - –Ø–∫—â–æ NET size ‚âà 0 ‚Üí hedge –∫–æ–º–ø–µ–Ω—Å—É—î parent –ø–æ–≤–Ω—ñ—Å—Ç—é
    
    Returns:
        True —è–∫—â–æ hedge –¥—ñ–π—Å–Ω–æ —ñ—Å–Ω—É—î –Ω–∞ –±—ñ—Ä–∂—ñ
    """
```

#### –ó–º—ñ–Ω–∞ 2: –ü–æ–∫—Ä–∞—â–µ–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ `update_position`
- –î–æ–¥–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è NET position –∑ exchange
- –õ–æ–≥—É–≤–∞—Ç–∏ –≤—Å—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ hedge
- –õ–æ–≥—É–≤–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è `has_hedge` —Ñ–ª–∞–≥—É

### –§–∞–π–ª: `core/hedge_manager.py`

#### –ó–º—ñ–Ω–∞ 1: –î–æ–¥–∞—Ç–∏ –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ hedge –Ω–∞ –±—ñ—Ä–∂—ñ
```python
def verify_hedge_on_exchange(self, hedge_id: str) -> bool:
    """
    –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ hedge –ø–æ–∑–∏—Ü—ñ—è –¥—ñ–π—Å–Ω–æ —ñ—Å–Ω—É—î –Ω–∞ –±—ñ—Ä–∂—ñ.
    
    –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î NET position –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è.
    """
```

### –§–∞–π–ª: `main.py`

#### –ó–º—ñ–Ω–∞ 1: –ü–æ–∫—Ä–∞—â–µ–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–∑–∏—Ü—ñ–π
- –î–æ–¥–∞—Ç–∏ –≤–∏–≤–µ–¥–µ–Ω–Ω—è NET position –∑ exchange
- –î–æ–¥–∞—Ç–∏ –≤–∏–≤–µ–¥–µ–Ω–Ω—è hedge —Å—Ç–∞—Ç—É—Å—É
- –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É consistency –º—ñ–∂ tracked —Ç–∞ exchange

### –§–∞–π–ª: `core/order_manager.py`

#### –ó–º—ñ–Ω–∞ 1: –î–æ–¥–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è SL/TP –æ–ø–µ—Ä–∞—Ü—ñ–π
- –õ–æ–≥—É–≤–∞—Ç–∏ –≤—Å—ñ —Å–ø—Ä–æ–±–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è SL/TP
- –õ–æ–≥—É–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ (—É—Å–ø—ñ—Ö/–Ω–µ–≤–¥–∞—á–∞)
- –õ–æ–≥—É–≤–∞—Ç–∏ –ø—Ä–∏—á–∏–Ω–∏ –Ω–µ–≤–¥–∞—á
