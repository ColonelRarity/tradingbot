# –ü–ª–∞–Ω –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ –∑ –ª–æ–≥—É–≤–∞–Ω–Ω—è 14.01.2026

## –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ–±–ª–µ–º –∑ –ª–æ–≥—ñ–≤

### 1. üî¥ –ö–†–ò–¢–ò–ß–ù–ê: –ü–æ–º–∏–ª–∫–∞ "cannot access local variable 'OrderSide'"
**–ü—Ä–æ–±–ª–µ–º–∞:** `ERROR:core.hedge_manager:Failed to close hedge: cannot access local variable 'OrderSide' where it is not associated with a value`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–≤—Ç–æ—Ä–Ω–∏–π —ñ–º–ø–æ—Ä—Ç `OrderSide` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –±–ª–æ–∫—É try-except –≤ `_close_hedge()` –º–µ—Ç–æ–¥—ñ, —Ö–æ—á–∞ –≤—ñ–Ω –≤–∂–µ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ñ–∞–π–ª—É.

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:** –í–∏–¥–∞–ª–µ–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π —ñ–º–ø–æ—Ä—Ç `OrderSide` –∑ —Ä—è–¥–∫–∞ 428 –≤ `core/hedge_manager.py`.

**–§–∞–π–ª:** `core/hedge_manager.py`

---

### 2. ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: "SL/TP order missing on exchange" - –Ω–µ –≤–¥–∞—î—Ç—å—Å—è –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ –∑–∞–Ω–∞–¥—Ç–æ –±–ª–∏–∑—å–∫—É —Ü—ñ–Ω—É
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ä–¥–µ—Ä–∏ SL/TP –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω—ñ, –±–æ —Ü—ñ–Ω–∞ –∑–∞–Ω–∞–¥—Ç–æ –±–ª–∏–∑—å–∫–∞ –¥–æ –ø–æ—Ç–æ—á–Ω–æ—ó —Ü—ñ–Ω–∏.

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—ñ –æ—Ä–¥–µ—Ä—ñ–≤ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è, —á–∏ —Ü—ñ–Ω–∞ SL/TP –≤–∞–ª—ñ–¥–Ω–∞ –≤—ñ–¥–Ω–æ—Å–Ω–æ –ø–æ—Ç–æ—á–Ω–æ—ó —Ü—ñ–Ω–∏.

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:** 
- –î–æ–¥–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É –∫–æ—Ä–µ–∫—Ü—ñ—é —Ü—ñ–Ω–∏ SL/TP –ø—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—ñ, —è–∫—â–æ –≤–æ–Ω–∞ –∑–∞–Ω–∞–¥—Ç–æ –±–ª–∏–∑—å–∫–∞
- –î–ª—è LONG: SL –∫–æ—Ä–µ–≥—É—î—Ç—å—Å—è –¥–æ 0.1% –Ω–∏–∂—á–µ –ø–æ—Ç–æ—á–Ω–æ—ó —Ü—ñ–Ω–∏, TP - –¥–æ 0.1% –≤–∏—â–µ
- –î–ª—è SHORT: SL –∫–æ—Ä–µ–≥—É—î—Ç—å—Å—è –¥–æ 0.1% –≤–∏—â–µ –ø–æ—Ç–æ—á–Ω–æ—ó —Ü—ñ–Ω–∏, TP - –¥–æ 0.1% –Ω–∏–∂—á–µ
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å: 0.05% –¥–ª—è SL, 0.1% –¥–ª—è TP

**–§–∞–π–ª:** `core/position_tracker.py` (–º–µ—Ç–æ–¥ `_ensure_sl_tp_orders`)

---

### 3. ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: "Position side mismatch: tracked=SHORT, exchange=LONG"
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–∑–∏—Ü—ñ—ó –Ω–∞ –±—ñ—Ä–∂—ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞–Ω–∏–º –ø–æ–∑–∏—Ü—ñ—è–º, –æ—Å–æ–±–ª–∏–≤–æ –∫–æ–ª–∏ —î hedge.

**–ü—Ä–∏—á–∏–Ω–∞:** 
- –ö–æ–ª–∏ —î hedge, exchange –ø–æ–∫–∞–∑—É—î NET –ø–æ–∑–∏—Ü—ñ—é (parent + hedge), –∞ –Ω–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—É –ø–æ–∑–∏—Ü—ñ—é
- –ö–æ–ª–∏ hedge –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è, side –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**
- –ü–æ–∫—Ä–∞—â–µ–Ω–æ –ª–æ–≥—ñ–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó side –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º hedge
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ NET size vs parent size –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —á–∏ —ñ—Å–Ω—É—î hedge
- –Ø–∫—â–æ NET size ‚âà parent size, hedge –≤–≤–∞–∂–∞—î—Ç—å—Å—è –∑–∞–∫—Ä–∏—Ç–∏–º —ñ side —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î—Ç—å—Å—è
- –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó

**–§–∞–π–ª:** `main.py` (–º–µ—Ç–æ–¥ `_manage_all_positions`)

---

### 4. ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: "Library requires orderId parameter (library bug)" - –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫ –æ—Ä–¥–µ—Ä—ñ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** `get_open_orders()` –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ library bug, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Å–ø—Ä–æ–± –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –æ—Ä–¥–µ—Ä–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–∂–µ —ñ—Å–Ω—É–≤–∞—Ç–∏.

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–ª–∏ `get_open_orders()` –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ library bug, —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –æ—Ä–¥–µ—Ä–∏, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤.

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**
- –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É: —è–∫—â–æ `get_open_orders()` –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫ —ñ —î tracked order IDs, –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è
- –¶–µ –∑–∞–ø–æ–±—ñ–≥–∞—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—é –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –æ—Ä–¥–µ—Ä—ñ–≤
- –û—Ä–¥–µ—Ä–∏ –±—É–¥—É—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω—ñ –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ —Ü–∏–∫–ª—É

**–§–∞–π–ª:** `core/position_tracker.py` (–º–µ—Ç–æ–¥ `_ensure_sl_tp_orders`)

---

### 5. ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–æ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é —Ü—ñ–Ω –ø—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—ñ –æ—Ä–¥–µ—Ä—ñ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ä–¥–µ—Ä–∏ –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω—ñ, —è–∫—â–æ —Ü—ñ–Ω–∞ –Ω–µ –≤–∞–ª—ñ–¥–Ω–∞.

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**
- –î–æ–¥–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É –∫–æ—Ä–µ–∫—Ü—ñ—é —Ü—ñ–Ω–∏ SL/TP –ø—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—ó –≤—ñ–¥—Å—Ç–∞–Ω—ñ –≤—ñ–¥ –ø–æ—Ç–æ—á–Ω–æ—ó —Ü—ñ–Ω–∏
- –û–Ω–æ–≤–ª–µ–Ω–Ω—è tracked —Ü—ñ–Ω–∏ –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è

**–§–∞–π–ª:** `core/position_tracker.py` (–º–µ—Ç–æ–¥ `_ensure_sl_tp_orders`)

---

## –ü—ñ–¥—Å—É–º–æ–∫ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å

### –í–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
1. **core/hedge_manager.py**
   - –í–∏–¥–∞–ª–µ–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π —ñ–º–ø–æ—Ä—Ç `OrderSide`

2. **core/position_tracker.py**
   - –ü–æ–∫—Ä–∞—â–µ–Ω–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è SL/TP –æ—Ä–¥–µ—Ä—ñ–≤ –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—é –∫–æ—Ä–µ–∫—Ü—ñ—î—é —Ü—ñ–Ω–∏
   - –ü–æ–∫—Ä–∞—â–µ–Ω–æ –æ–±—Ä–æ–±–∫—É `get_open_orders()` –∫–æ–ª–∏ –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫

3. **main.py**
   - –ü–æ–∫—Ä–∞—â–µ–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é position side –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º hedge
   - –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É NET size –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É hedge

### –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:
- ‚úÖ –ë—ñ–ª—å—à–µ –Ω–µ –±—É–¥–µ –ø–æ–º–∏–ª–æ–∫ "cannot access local variable 'OrderSide'"
- ‚úÖ SL/TP –æ—Ä–¥–µ—Ä–∏ –±—É–¥—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞—Ç–∏—Å—è –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ü—ñ–Ω–∏
- ‚úÖ Position side –±—É–¥–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏—Å—è –∑ –±—ñ—Ä–∂–µ—é
- ‚úÖ –ù–µ –±—É–¥–µ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –æ—Ä–¥–µ—Ä—ñ–≤ –ø—Ä–∏ library bug
- ‚úÖ –ö—Ä–∞—â–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è

### –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:
1. –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –±–æ—Ç–∞ –∑ –Ω–æ–≤–∏–º–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º–∏
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ñ–¥–Ω–æ–≤–ª—é—é—Ç—å—Å—è SL/TP –æ—Ä–¥–µ—Ä–∏
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î—Ç—å—Å—è position side
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –Ω–µ–º–∞—î –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –æ—Ä–¥–µ—Ä—ñ–≤

---

## –î–µ—Ç–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–∏ –≤ –∫–æ–¥—ñ

### `core/hedge_manager.py`
- **–†—è–¥–æ–∫ 428:** –í–∏–¥–∞–ª–µ–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π —ñ–º–ø–æ—Ä—Ç `from exchange.binance_client import OrderSide`
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `OrderSide`, —è–∫–∏–π –≤–∂–µ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ñ–∞–π–ª—É

### `core/position_tracker.py`
- **–ú–µ—Ç–æ–¥ `_ensure_sl_tp_orders`:** 
  - –î–æ–¥–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É –∫–æ—Ä–µ–∫—Ü—ñ—é —Ü—ñ–Ω–∏ SL/TP –ø—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—ñ
  - –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ç–∞ –ø—Ä–æ–ø—É—Å–∫ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è, —è–∫—â–æ `get_open_orders()` –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ library bug
  - –û–Ω–æ–≤–ª–µ–Ω–Ω—è tracked —Ü—ñ–Ω–∏ –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è

### `main.py`
- **–ú–µ—Ç–æ–¥ `_manage_all_positions`:**
  - –ü–æ–∫—Ä–∞—â–µ–Ω–æ –ª–æ–≥—ñ–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó position side –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º hedge
  - –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É NET size –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É hedge
  - –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó

---

*–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è: 14.01.2026*
*–í—Å—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω—ñ —Ç–∞ –≥–æ—Ç–æ–≤—ñ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è*
